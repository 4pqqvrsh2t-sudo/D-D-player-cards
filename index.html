<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>D&D Ability Tech Tree Builder</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="page">
      <header class="hero">
        <p class="eyebrow">D&D Campaign Tool</p>
        <h1>Ability Tech Tree Builder</h1>
        <p>Use tabs for role-based trees (Tank, Long Range, Support), each with its own web.</p>
      </header>

      <section class="panel">
        <div class="tabs-head">
          <h2>Role Tabs</h2>
          <button id="editTabsButton" type="button" class="ghost edit-tabs-btn" aria-pressed="false">Edit</button>
        </div>
        <div id="tabBar" class="tab-bar" role="tablist" aria-label="Ability tree categories"></div>
      </section>

      <section class="panel">
        <div class="tree-head">
          <h2 id="treeTitle">Spells &amp; Abilities</h2>
          <div class="tree-head-actions">
            <button id="filterWebButton" type="button" class="ghost filter-web-btn" aria-pressed="false">Filter</button>
            <button id="editWebButton" type="button" class="ghost edit-web-btn" aria-pressed="false">Edit</button>
          </div>
        </div>
        <div id="filterPanel" class="filter-panel" hidden>
          <label>
            Filter by
            <select id="filterMode" name="filterMode">
              <option value="none" selected>None</option>
              <option value="descriptionType">Description type</option>
              <option value="tag">Tag</option>
            </select>
          </label>
          <label>
            Value
            <select id="filterValue" name="filterValue" disabled>
              <option value="">Select a filter</option>
            </select>
          </label>
          <button id="clearFilter" type="button" class="ghost">Clear Filter</button>
        </div>
        <div id="treeCanvas"></div>
        <div id="spellInfoCard" class="spell-info-card" hidden></div>
      </section>

      <section class="panel">
        <h2>Add Ability</h2>
        <form id="abilityForm" class="ability-form">
          <label>
            Ability name
            <input id="abilityName" name="abilityName" type="text" required placeholder="e.g. Arcane Echo" />
          </label>

          <label>
            Tier
            <select id="abilityTier" name="abilityTier">
              <option value="0">Tier 1</option>
              <option value="1">Tier 2</option>
              <option value="2">Tier 3</option>
              <option value="3">Tier 4</option>
              <option value="4">Tier 5</option>
            </select>
          </label>

          <label>
            Importance
            <select id="abilityImportance" name="abilityImportance">
              <option value="minor">Small (Minor)</option>
              <option value="base" selected>Medium (Base)</option>
              <option value="major">Large (Major)</option>
              <option value="main">XL (Main)</option>
            </select>
          </label>

          <label>
            Prerequisites
            <select id="abilityPrereq" name="abilityPrereq" required>
            </select>
          </label>

          <label>
            Description type
            <select id="abilityKind" name="abilityKind">
              <option value="Spell" selected>Spell</option>
              <option value="Stance">Stance</option>
              <option value="Skill">Skill</option>
            </select>
          </label>

          <div class="form-row">
            <label class="description-field">
              Spell description
              <textarea id="abilitySpellDescription" name="abilitySpellDescription" rows="3" maxlength="240" placeholder="Describe what this spell does..."></textarea>
            </label>

            <label>
              Damage Dice
              <select id="abilityDamageDice" name="abilityDamageDice">
                <option value="">None</option>
                <option value="1d4">1d4</option>
                <option value="1d6">1d6</option>
                <option value="1d8">1d8</option>
                <option value="1d10">1d10</option>
                <option value="1d12">1d12</option>
                <option value="2d4">2d4</option>
                <option value="2d6">2d6</option>
                <option value="2d8">2d8</option>
                <option value="2d10">2d10</option>
                <option value="2d12">2d12</option>
                <option value="3d4">3d4</option>
                <option value="3d6">3d6</option>
                <option value="3d8">3d8</option>
                <option value="3d10">3d10</option>
                <option value="3d12">3d12</option>
                <option value="4d4">4d4</option>
                <option value="4d6">4d6</option>
                <option value="4d8">4d8</option>
                <option value="4d10">4d10</option>
                <option value="4d12">4d12</option>
                <option value="6d6">6d6</option>
                <option value="8d6">8d6</option>
                <option value="10d6">10d6</option>
                <option value="12d6">12d6</option>
                <option value="15d6">15d6</option>
              </select>
            </label>
          </div>

          <div class="tag-picker-wrap" aria-label="Ability tags">
            <p class="tag-picker-title">Tags (invisible metadata)</p>
            <div id="tagPicker" class="tag-picker" role="group" aria-label="Choose ability tags"></div>
            <button id="clearTags" type="button" class="ghost clear-tags-btn">Remove all tags</button>
          </div>

          <label>
            Status
            <select id="abilityStatus" name="abilityStatus">
              <option value="locked">Locked</option>
              <option value="unlocked" selected>Unlocked</option>
            </select>
          </label>

          <label>
            Type
            <select id="abilityType" name="abilityType">
              <option value="Conventional" selected>Conventional</option>
              <option value="Unconventional">Unconventional</option>
              <option value="Forbidden">Forbidden</option>
            </select>
          </label>

          <div class="actions">
            <button type="submit">Add Ability</button>
            <button id="resetTree" type="button" class="ghost">Reset Current Tab</button>
          </div>
        </form>
      </section>

    </main>

    <div id="confirmOverlay" class="confirm-overlay" hidden>
      <div class="confirm-modal" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
        <h3 id="confirmTitle">Are you sure? This action is <strong class="permanent-word">Permanent</strong>.</h3>
        <p id="confirmMessage" class="confirm-message"></p>
        <div class="confirm-actions">
          <button id="confirmYes" type="button">Yes</button>
          <button id="confirmNo" type="button" class="ghost">No</button>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
